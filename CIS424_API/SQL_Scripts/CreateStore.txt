USE [capstone_db_01]
GO

/** Object: StoredProcedure [dbo].[sp_CreateStore] Script Date: 1/30/2024 **/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[sp_CreateStore]
    @location VARCHAR(50),
    @ResultMessage VARCHAR(255) OUTPUT
AS
BEGIN
    SET NOCOUNT ON;

    -- Check if there is no existing record with ID 0 for Store
    IF NOT EXISTS (SELECT 1 FROM [dbo].[Store] WHERE [ID] = 0)
    BEGIN
        -- Temporarily allow explicit values for ID column
        SET IDENTITY_INSERT [dbo].[Store] ON;

        -- Create a record with ID 0 and a dummy location
        INSERT INTO [dbo].[Store] ([ID], [location])
        VALUES (0, 'Dummy');

        -- Turn off explicit values for ID column
        SET IDENTITY_INSERT [dbo].[Store] OFF;
    END;

    -- Insert the new store into the Stores table
    INSERT INTO [dbo].[Store] (location)
    VALUES (@location); -- Replace with the actual location

    SET @ResultMessage = 'Store created successfully.';
END;
GO